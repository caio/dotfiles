#!/bin/bash

REPO=/home/rcaio/src/work/upp
DIRS=( $REPO/ppack/wui $REPO/common/wui )
MOUNTPOINT="/opt/wui"


do_mount() {
    echo "Mounting UnionFS on $MOUNTPOINT"

    for d in ${DIRS[@]}; do
        PARAMS="${PARAMS}${d}=RW:"
    done
    PARAMS="${PARAMS%:}"
    unionfs -o allow_other $PARAMS $MOUNTPOINT
}

do_umount() {
    echo "Unmounting $MOUNTPOINT"
    fusermount -u $MOUNTPOINT
}

if mount|grep $MOUNTPOINT >/dev/null; then
    do_umount
else
    do_mount
fi

